---
title: "R Notebook"
output:
  html_document:
    df_print: paged
---

# Data Generation

```{r}
library(MVN) 
library(dplyr)

set.seed(420)

mean <- seq(0,2)
vcm <- matrix(data = c(1,1,1.7,1,2, 1.5, 1.7, 1.5, 4), nrow = 3, byrow = T)

data <- data.frame(MASS::mvrnorm(n = 1000, mu = mean, Sigma = vcm))
colnames(data) <- c("X", "Y", "W")
```


# task a)

The goal is to infer about the regression coefficient for X in the model $Y = \beta_0 + \beta_1X + \varepsilon , \varepsilon \sim N(0, \sigma^2)$. Set aside the first 900 observations as data from the main study and treat the remaining 100 observations as data from a substudy. Fit the above regression model on the main study data and store the point estimates of $\beta_0$, $\beta_1$ and $\sigma^2$ and the interval estimate of $\beta_1$.

```{r}
#Set aside first 900 obs as data from main study
Main <- data %>% slice_head(n = 900)

#Remaining 100 observations as data from a substudy
Sub <- data %>% slice_tail(n = 100)

#Fit regression model on the main study 
Main.lm <- lm(Y ~ X, data = Main)

#Generate point estimates for βo, β1, σ  and  interval estimate of β1
beta_0_main <- lm(Y ~ X, data = Main)$coef[1]
beta_1_main <- lm(Y ~ X, data = Main)$coef[2]
Sigma_main <- sigma(Main.lm)

int_est_beta_1 <- confint(Main.lm)[2,]
```


# task b)

Create a data corresponding to scenario (a) in Figure 8.1 by deleting X from the main study. Multiply impute the missing values of X in the main study. Perform multiply imputed analysis and again store the point and interval estimates of the same parameters.

* Figure 8.1 not included in the script

```{r}

```

# task c)

Create a data corresponding to scenario (b) by deleting X values from the main study and Y values from the substudy. Multiply impute the missing values of X in the main study. Perform multiply imputed analysis as in (b).

```{r}

```


# task d)

Create a data corresponding to scenario (c) by deleting X on the main study, Y from the first 50 subjects in the substudy 172 Missing Data Analysis in Practice
and W from the last 50 subjects. Perform multiply imputed analysis as in (b).

```{r}

```


# task e)

Generate new samples and repeat the process (a) to (d), 250 times.

```{r}

```


# task f)

Compare the bias and mean square properties of the estimates of $\beta_0$, $\beta_1$ and $\sigma^2$.

```{r}

```


# task g)

Compute the true value of $\beta_1$ and calculate the actual coverage rate for each method of estimating the confidence interval. Also, calculate the length of the confidence intervals.

```{r}

```

